with p as (select to_date(:1,'YYYY-MM-DD') as create_date,:2 as dc FROM dual)
select
OD_IN_SAP,OD_IN_WMS,OD_NOT_IN_WMS,OD_IN_TMS,OD_NOT_IN_TMS,OD_PLANNNED_IN_TMS, OD_NOT_PLANNED_IN_TMS,WM_ROUTE_PRESENT,WM_ROUTE_NOT_PRESENT,WH
from
(
SELECT nvl(sum(b),0) OD_IN_SAP,whse WH from(
SELECT SAP_CRT_DTTM,COUNT(od) b,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse
) od_in_sap
left outer join (
SELECT nvl(sum(c),0) OD_IN_WMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD_IN_WMS) c,whse FROM scvmgr.sapod_test, p WHERE (trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND OD_IN_WMS ='YES')
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) OD_IN_WM on WH = OD_IN_WM.whse
left outer join
(
//SELECT nvl(sum(d),0) OD_NOT_IN_WMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD_IN_WMS) d,whse FROM scvmgr.sapod_test, p WHERE (trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND OD_IN_WMS='NO')
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) od_not_in_wm on WH=od_not_in_wm.whse
left outer join
(
SELECT nvl(sum(e),0) OD_IN_TMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD_IN_TMS) e,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND OD_IN_TMS='YES' AND ROUTING_TEAM='I2'
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) od_in_tm on WH= od_in_tm.whse
left outer join
(
//SELECT nvl(sum(f),0) OD_NOT_IN_TMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD_IN_TMS) f,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND OD_IN_TMS='NO' AND ROUTING_TEAM='I2'
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) od_not_in_tm on WH=od_not_in_tm.whse
left outer join
(
SELECT nvl(sum(h),0) OD_PLANNNED_IN_TMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD) h,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND LD_LEG_ID IS NOT NULL
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) od_planned_in_tm on WH=od_planned_in_tm.whse
left outer join
(
SELECT nvl(sum(i),0) OD_NOT_PLANNED_IN_TMS,whse from(
SELECT SAP_CRT_DTTM,COUNT(OD) i,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND (LD_LEG_ID IS NULL)
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) od_not_planned_in_tm on WH=od_not_planned_in_tm.whse
left outer join
(
SELECT nvl(sum(j),0) WM_ROUTE_PRESENT,whse from(
SELECT SAP_CRT_DTTM,COUNT(WM_ROUTE_PRESENT) j,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND WM_ROUTE_PRESENT='YES'
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) wm_present on WH=wm_present.whse
left outer join
(
SELECT nvl(sum(k),0) WM_ROUTE_NOT_PRESENT,whse from(
SELECT SAP_CRT_DTTM,COUNT(WM_ROUTE_PRESENT) k,whse FROM scvmgr.sapod_test, p WHERE trunc(sap_crt_dttm)=trunc(p.create_date) AND instr(p.dc,whse)>=1 AND WM_ROUTE_PRESENT='NO'
GROUP BY SAP_CRT_DTTM,whse
order by SAP_CRT_DTTM)
group by whse) wm_not_present on WH=wm_not_present.whse
